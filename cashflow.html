<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cash Flow Analysis - Financial Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f8f9fa;
            color: #333;
        }

        .header {
            background: white;
            padding: 15px 24px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .menu-icon {
            width: 20px;
            height: 20px;
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .menu-icon div {
            background: #333;
            height: 2px;
            width: 100%;
        }

        .logo {
            font-size: 20px;
            font-weight: 600;
            color: #1976d2;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #ff9800;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
        }

        .container {
            display: flex;
            min-height: calc(100vh - 65px);
        }

        .sidebar {
            width: 240px;
            background: white;
            border-right: 1px solid #e9ecef;
            padding: 20px 0;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 24px;
            color: #666;
            text-decoration: none;
            transition: all 0.2s;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: #f8f9fa;
            color: #1976d2;
        }

        .nav-item.active {
            background: #e3f2fd;
            color: #1976d2;
            border-left-color: #1976d2;
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            fill: currentColor;
        }

        .main-content {
            flex: 1;
            padding: 32px;
        }

        .page-header {
            margin-bottom: 32px;
        }

        .page-title {
            font-size: 28px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .page-subtitle {
            color: #666;
            font-size: 16px;
        }

        .controls {
            background: white;
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .control-group {
            display: flex;
            gap: 20px;
            align-items: end;
        }

        .control-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .control-label {
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }

        .control-input {
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            min-width: 150px;
        }

        .btn-analyze {
            background: #1976d2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.2s;
        }

        .btn-analyze:hover {
            background: #1565c0;
        }

        .cash-flow-summary {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 24px;
        }

        .summary-card {
            background: white;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
        }

        .summary-card.inflow {
            border-left: 4px solid #4caf50;
        }

        .summary-card.outflow {
            border-left: 4px solid #f44336;
        }

        .summary-card.net {
            border-left: 4px solid #2196f3;
        }

        .summary-title {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
            text-transform: uppercase;
            font-weight: 500;
        }

        .summary-amount {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .summary-card.inflow .summary-amount {
            color: #4caf50;
        }

        .summary-card.outflow .summary-amount {
            color: #f44336;
        }

        .summary-card.net .summary-amount {
            color: #2196f3;
        }

        .summary-period {
            font-size: 12px;
            color: #999;
        }

        .chart-container {
            background: white;
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        .chart-toggle {
            display: flex;
            background: #f5f5f5;
            border-radius: 6px;
            padding: 4px;
        }

        .toggle-btn {
            padding: 8px 16px;
            border: none;
            background: transparent;
            cursor: pointer;
            border-radius: 4px;
            font-size: 14px;
            transition: all 0.2s;
        }

        .toggle-btn.active {
            background: #1976d2;
            color: white;
        }

        .chart-area {
            height: 300px;
            background: #f8f9fa;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .chart-bars {
            display: flex;
            align-items: end;
            gap: 40px;
            height: 250px;
            padding: 20px;
        }

        .bar-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .bar {
            width: 60px;
            border-radius: 4px 4px 0 0;
            position: relative;
        }

        .bar.inflow {
            background: linear-gradient(180deg, #66bb6a 0%, #4caf50 100%);
        }

        .bar.outflow {
            background: linear-gradient(180deg, #ef5350 0%, #f44336 100%);
        }

        .bar-label {
            font-size: 12px;
            font-weight: 600;
            color: #333;
        }

        .bar-value {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 11px;
            font-weight: 600;
            color: #666;
        }

        .suggestions {
            background: white;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .suggestions-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .suggestion-icon {
            width: 20px;
            height: 20px;
            background: #ff9800;
            border-radius: 50%;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .suggestion-item {
            background: #f8f9fa;
            border-left: 4px solid #ff9800;
            padding: 16px;
            margin-bottom: 12px;
            border-radius: 0 6px 6px 0;
        }

        .suggestion-text {
            color: #333;
            line-height: 1.5;
        }

        .no-data {
            text-align: center;
            color: #666;
            font-style: italic;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-left">
            <div class="menu-icon">
                <div></div>
                <div></div>
                <div></div>
            </div>
            <div class="logo">Financial Tool</div>
        </div>
        <div class="user-info">
            <div class="avatar">S</div>
            <span>Sravani</span>
        </div>
    </header>

    <div class="container">
        <nav class="sidebar">
            <a href="#" class="nav-item">
                <svg class="nav-icon" viewBox="0 0 24 24">
                    <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
                </svg>
                Dashboard
            </a>
            <a href="#" class="nav-item">
                <svg class="nav-icon" viewBox="0 0 24 24">
                    <path d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"/>
                </svg>
                NetWorth
            </a>
            <a href="#" class="nav-item">
                <svg class="nav-icon" viewBox="0 0 24 24">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                </svg>
                Assets & Liabilities
            </a>
            <a href="#" class="nav-item active">
                <svg class="nav-icon" viewBox="0 0 24 24">
                    <path d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"/>
                </svg>
                Cashflows
            </a>
            <a href="#" class="nav-item">
                <svg class="nav-icon" viewBox="0 0 24 24">
                    <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
                </svg>
                Transaction Details
            </a>
            <a href="#" class="nav-item">
                <svg class="nav-icon" viewBox="0 0 24 24">
                    <path d="M16 4c0-1.11.89-2 2-2s2 .89 2 2-.89 2-2 2-2-.89-2-2zm4 18v-6h2.5l-2.54-7.63A2.998 2.998 0 0 0 16.96 6c-.8 0-1.54.37-2.01.97l-2.76 3.59c-.65.85-.32 2.07.53 2.72l3.03 2.32V22h2zm-7.5-10.5c.83 0 1.5-.67 1.5-1.5s-.67-1.5-1.5-1.5S11 9.17 11 10s.67 1.5 1.5 1.5zM5.5 6c1.11 0 2-.89 2-2s-.89-2-2-2-2 .89-2 2 .89 2 2 2zm2.5 16v-7H6v-2.5c0-.83.67-1.5 1.5-1.5h2c.83 0 1.5.67 1.5 1.5V15H9v7h-1z"/>
                </svg>
                Family Members
            </a>
            <a href="#" class="nav-item">
                <svg class="nav-icon" viewBox="0 0 24 24">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
                Accounts
            </a>
        </nav>

        <main class="main-content">
            <div class="page-header">
                <h1 class="page-title">Cash Flow Analysis</h1>
                <p class="page-subtitle">Track your income and expenses with detailed monthly analysis</p>
            </div>

            <div class="controls">
                <div class="control-group">
                    <div class="control-item">
                        <label class="control-label">Select Month</label>
                        <select class="control-input" id="monthSelect">
                            <option value="01">January</option>
                            <option value="02">February</option>
                            <option value="03">March</option>
                            <option value="04">April</option>
                            <option value="05">May</option>
                            <option value="06">June</option>
                            <option value="07">July</option>
                            <option value="08" selected>August</option>
                            <option value="09">September</option>
                            <option value="10">October</option>
                            <option value="11">November</option>
                            <option value="12">December</option>
                        </select>
                    </div>
                    <div class="control-item">
                        <label class="control-label">Select Year</label>
                        <select class="control-input" id="yearSelect">
                            <option value="2023">2023</option>
                            <option value="2024">2024</option>
                            <option value="2025" selected>2025</option>
                        </select>
                    </div>
                    <div class="control-item">
                        <label class="control-label">Family Member</label>
                        <select class="control-input" id="memberSelect">
                            <option value="all">All Members</option>
                            <option value="sravani">Sravani</option>
                            <option value="pala-kumar">Pala Kumar</option>
                            <option value="santosh">Santosh Kumar</option>
                            <option value="manepalli">Manepalli Prabhu</option>
                        </select>
                    </div>
                    <button class="btn-analyze" onclick="analyzeCashFlow()">Analyze</button>
                </div>
            </div>

            <div class="cash-flow-summary" id="summaryCards">
                <div class="summary-card inflow">
                    <div class="summary-title">Cash Inflow</div>
                    <div class="summary-amount">â‚¹85,500</div>
                    <div class="summary-period">August 2025</div>
                </div>
                <div class="summary-card outflow">
                    <div class="summary-title">Cash Outflow</div>
                    <div class="summary-amount">â‚¹62,300</div>
                    <div class="summary-period">August 2025</div>
                </div>
                <div class="summary-card net">
                    <div class="summary-title">Net Cash Flow</div>
                    <div class="summary-amount">â‚¹23,200</div>
                    <div class="summary-period">August 2025</div>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-header">
                    <h3 class="chart-title">Cash Flow Comparison</h3>
                    <div class="chart-toggle">
                        <button class="toggle-btn active" onclick="toggleChart('actual')">Actual</button>
                        <button class="toggle-btn" onclick="toggleChart('projected')">Projected</button>
                    </div>
                </div>
                <div class="chart-area">
                    <div class="chart-bars" id="chartBars">
                        <div class="bar-group">
                            <div class="bar inflow" style="height: 200px;">
                                <div class="bar-value">â‚¹85.5K</div>
                            </div>
                            <div class="bar-label">Cash Inflow</div>
                        </div>
                        <div class="bar-group">
                            <div class="bar outflow" style="height: 145px;">
                                <div class="bar-value">â‚¹62.3K</div>
                            </div>
                            <div class="bar-label">Cash Outflow</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="suggestions">
                <h3 class="suggestions-title">
                    <div class="suggestion-icon">ðŸ’¡</div>
                    Financial Insights & Suggestions
                </h3>
                <div class="suggestion-item">
                    <div class="suggestion-text">
                        <strong>Positive Cash Flow:</strong> Your cash inflow exceeds outflow by â‚¹23,200 this month. Consider investing this surplus in a high-yield savings account or mutual funds for better returns.
                    </div>
                </div>
                <div class="suggestion-item">
                    <div class="suggestion-text">
                        <strong>Expense Optimization:</strong> Your monthly expenses represent 72.8% of your income, which is within a healthy range. However, review discretionary spending to increase your savings rate.
                    </div>
                </div>
                <div class="suggestion-item">
                    <div class="suggestion-text">
                        <strong>Emergency Fund:</strong> Maintain at least 3-6 months of expenses (â‚¹186K - â‚¹373K) as an emergency fund. Your current positive cash flow can help build this buffer.
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Sample data structure matching your JSON format
        const cashFlowData = {
            "2025": {
                "08": {
                    actual: {
                        cash_inflow: 85500,
                        cash_outflow: 62300,
                        net_cash_flow: 23200,
                        cashflow_type: "actual"
                    },
                    projected: {
                        cash_inflow: 90000,
                        cash_outflow: 65000,
                        net_cash_flow: 25000,
                        cashflow_type: "projected"
                    }
                },
                "07": {
                    actual: {
                        cash_inflow: 78000,
                        cash_outflow: 58000,
                        net_cash_flow: 20000,
                        cashflow_type: "actual"
                    },
                    projected: {
                        cash_inflow: 85000,
                        cash_outflow: 60000,
                        net_cash_flow: 25000,
                        cashflow_type: "projected"
                    }
                }
            },
            "2024": {
                "12": {
                    actual: {
                        cash_inflow: 92000,
                        cash_outflow: 68000,
                        net_cash_flow: 24000,
                        cashflow_type: "actual"
                    },
                    projected: {
                        cash_inflow: 88000,
                        cash_outflow: 65000,
                        net_cash_flow: 23000,
                        cashflow_type: "projected"
                    }
                }
            }
        };

        let currentView = 'actual';

        function formatCurrency(amount) {
            if (amount >= 100000) {
                return `â‚¹${(amount / 1000).toFixed(1)}K`;
            } else if (amount >= 1000) {
                return `â‚¹${(amount / 1000).toFixed(1)}K`;
            }
            return `â‚¹${amount.toLocaleString()}`;
        }

        function getMonthName(monthNum) {
            const months = [
                'January', 'February', 'March', 'April', 'May', 'June',
                'July', 'August', 'September', 'October', 'November', 'December'
            ];
            return months[parseInt(monthNum) - 1];
        }

        function generateSuggestions(data) {
            const suggestions = [];
            const { cash_inflow, cash_outflow, net_cash_flow } = data;

            if (net_cash_flow > 0) {
                suggestions.push({
                    title: "Positive Cash Flow",
                    text: `Your cash inflow exceeds outflow by ${formatCurrency(net_cash_flow)} this month. Consider investing this surplus in a high-yield savings account or mutual funds for better returns.`
                });
            } else if (net_cash_flow < 0) {
                suggestions.push({
                    title: "Negative Cash Flow",
                    text: `Your expenses exceed income by ${formatCurrency(Math.abs(net_cash_flow))} this month. Review your spending categories and identify areas for cost reduction.`
                });
            }

            const expenseRatio = (cash_outflow / cash_inflow * 100).toFixed(1);
            if (expenseRatio > 80) {
                suggestions.push({
                    title: "High Expense Ratio",
                    text: `Your expenses represent ${expenseRatio}% of your income. Aim to keep expenses below 70% to maintain healthy savings.`
                });
            } else {
                suggestions.push({
                    title: "Expense Optimization",
                    text: `Your monthly expenses represent ${expenseRatio}% of your income, which is within a healthy range. However, review discretionary spending to increase your savings rate.`
                });
            }

            const emergencyFundMin = cash_outflow * 3;
            const emergencyFundMax = cash_outflow * 6;
            suggestions.push({
                title: "Emergency Fund",
                text: `Maintain at least 3-6 months of expenses (${formatCurrency(emergencyFundMin)} - ${formatCurrency(emergencyFundMax)}) as an emergency fund. Your current ${net_cash_flow > 0 ? 'positive' : 'negative'} cash flow can help ${net_cash_flow > 0 ? 'build this buffer' : 'requires immediate attention'}.`
            });

            return suggestions;
        }

        function updateSuggestions(data) {
            const suggestionsContainer = document.querySelector('.suggestions');
            const suggestions = generateSuggestions(data);

            const suggestionsHTML = `
                <h3 class="suggestions-title">
                    <div class="suggestion-icon">ðŸ’¡</div>
                    Financial Insights & Suggestions
                </h3>
                ${suggestions.map(suggestion => `
                    <div class="suggestion-item">
                        <div class="suggestion-text">
                            <strong>${suggestion.title}:</strong> ${suggestion.text}
                        </div>
                    </div>
                `).join('')}
            `;

            suggestionsContainer.innerHTML = suggestionsHTML;
        }

        function toggleChart(view) {
            currentView = view;

            // Update toggle buttons
            document.querySelectorAll('.toggle-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            analyzeCashFlow();
        }

        function analyzeCashFlow() {
            const month = document.getElementById('monthSelect').value;
            const year = document.getElementById('yearSelect').value;

            const data = cashFlowData[year] && cashFlowData[year][month] &&
                        cashFlowData[year][month][currentView];

            if (data) {
                // Update summary cards
                const monthName = getMonthName(month);
                document.querySelector('.summary-card.inflow .summary-amount').textContent = formatCurrency(data.cash_inflow);
                document.querySelector('.summary-card.inflow .summary-period').textContent = `${monthName} ${year}`;

                document.querySelector('.summary-card.outflow .summary-amount').textContent = formatCurrency(data.cash_outflow);
                document.querySelector('.summary-card.outflow .summary-period').textContent = `${monthName} ${year}`;

                document.querySelector('.summary-card.net .summary-amount').textContent = formatCurrency(data.net_cash_flow);
                document.querySelector('.summary-card.net .summary-period').textContent = `${monthName} ${year}`;

                // Update chart
                const maxAmount = Math.max(data.cash_inflow, data.cash_outflow);
                const inflowHeight = (data.cash_inflow / maxAmount) * 200;
                const outflowHeight = (data.cash_outflow / maxAmount) * 200;

                const chartBars = document.getElementById('chartBars');
                chartBars.innerHTML = `
                    <div class="bar-group">
                        <div class="bar inflow" style="height: ${inflowHeight}px;">
                            <div class="bar-value">${formatCurrency(data.cash_inflow)}</div>
                        </div>
                        <div class="bar-label">Cash Inflow (${currentView})</div>
                    </div>
                    <div class="bar-group">
                        <div class="bar outflow" style="height: ${outflowHeight};">
                            <div class="bar-value">${formatCurrency(data.cash_outflow)}</div>
                        </div>
                        <div class="bar-label">Cash Outflow (${currentView})</div>
                    </div>
                `;

                // Update suggestions
                updateSuggestions(data);
            } else {
                // Handle no data case
                document.querySelector('.summary-card.inflow .summary-amount').textContent = 'â‚¹0';
                document.querySelector('.summary-card.outflow .summary-amount').textContent = 'â‚¹0';
                document.querySelector('.summary-card.net .summary-amount').textContent = 'â‚¹0';

                const chartBars = document.getElementById('chartBars');
                chartBars.innerHTML = '<div class="no-data">No data available for selected period</div>';

                // Show default suggestions
                document.querySelector('.suggestions').innerHTML = `
                    <h3 class="suggestions-title">
                        <div class="suggestion-icon">ðŸ’¡</div>
                        Financial Insights & Suggestions
                    </h3>
                    <div class="suggestion-item">
                        <div class="suggestion-text">
                            <strong>No Data Available:</strong> Please select a different month and year, or ensure your financial data has been uploaded for analysis.
                        </div>
                    </div>
                `;
            }
        }

        // Initialize with the current selection
        document.addEventListener('DOMContentLoaded', function() {
            analyzeCashFlow();
        });
    </script>
</body>
</html>