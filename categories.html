<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Financial Tool - Budget Allocation</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
  <!-- Layout -->
  <div class="flex">
    <!-- Sidebar -->
    <aside class="w-60 bg-white shadow-md h-screen">
      <div class="p-4 text-blue-700 font-bold text-lg">📊 Financial Tool</div>
      <nav>
        <a href="#" class="flex items-center px-4 py-2 bg-blue-600 text-white rounded-md my-2">Categories</a>
        <a href="#" class="flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-md my-2">Income Declaration</a>
        <a href="#" class="flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-md my-2">Asset Declaration</a>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-6">
      <div class="flex justify-between items-center mb-6">
        <h1 class="text-2xl font-semibold text-gray-700">Budget Allocation</h1>
        <button onclick="openModal()" class="bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700">
          + Add Category
        </button>
      </div>

      <!-- Income Input -->
      <div class="bg-white p-6 rounded-xl shadow-sm mb-6">
        <label class="block text-gray-600 font-medium mb-2">Enter Monthly Income</label>
        <input type="number" id="incomeInput" placeholder="e.g. 50000"
          class="w-full border rounded-lg px-4 py-2 mb-4 focus:outline-none focus:ring-2 focus:ring-blue-400" />
        <button onclick="calculateBudget()" class="bg-blue-600 text-white px-6 py-2 rounded-lg shadow hover:bg-blue-700">
          Calculate Allocation
        </button>
      </div>

      <!-- Categories Table -->
      <div class="bg-white p-6 rounded-xl shadow-sm">
        <h2 class="text-xl font-semibold text-gray-700 mb-4">Categories</h2>
        <div class="overflow-x-auto rounded-lg shadow">
          <table class="w-full border-collapse">
            <thead>
              <tr class="bg-gray-100 text-gray-700 text-left">
                <th class="p-3">Head</th>
                <th class="p-3">Main Classification</th>
                <th class="p-3">Sub Classification</th>
                <th class="p-3">Type</th>
                <th class="p-3">Frequency</th>
                <th class="p-3">Source</th>
                <th class="p-3">Budget Allocation (%)</th>
                <th class="p-3">Amount</th>
                <th class="p-3">Actions</th>
              </tr>
            </thead>
            <tbody id="budgetTableBody" class="text-gray-600">
              <!-- Dynamic rows -->
            </tbody>
          </table>
        </div>
      </div>
    </main>
  </div>

  <!-- Modal -->
  <div id="categoryModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center">
    <div class="bg-white p-6 rounded-lg w-96 shadow-lg">
      <h2 class="text-lg font-semibold mb-4">Add Category</h2>
      <select id="newHead" class="w-full border rounded-lg px-3 py-2 mb-3">
        <option value="Expenditure">Expenditure</option>
        <option value="Income">Income</option>
      </select>
      <input type="text" id="newMainClass" placeholder="Main Classification"
        class="w-full border rounded-lg px-3 py-2 mb-3" />
      <input type="text" id="newSubClass" placeholder="Sub Classification"
        class="w-full border rounded-lg px-3 py-2 mb-3" />
      <select id="newType" class="w-full border rounded-lg px-3 py-2 mb-3">
        <option value="Mandatory">Mandatory</option>
        <option value="Optional">Optional</option>
      </select>
      <select id="newFreq" class="w-full border rounded-lg px-3 py-2 mb-3">
        <option value="Not Available">Not Available</option>
        <option value="Monthly">Monthly</option>
        <option value="Yearly">Yearly</option>
      </select>
      <input type="number" id="newPercent" placeholder="Budget Allocation %"
        class="w-full border rounded-lg px-3 py-2 mb-3" />
      <div class="flex justify-end space-x-2">
        <button onclick="closeModal()" class="px-4 py-2 rounded-lg border">Cancel</button>
        <button onclick="addCategory()" class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700">Add</button>
      </div>
    </div>
  </div>

  <!-- JS -->
  <script>
    let categories = [
      { head: "Expenditure", main: "Appliance Maintenance", sub: "Air Conditioners", type: "Mandatory", freq: "Not Available", source: "System", percent: 5 },
      { head: "Expenditure", main: "Appliance Maintenance", sub: "Refrigerator", type: "Mandatory", freq: "Not Available", source: "System", percent: 5 },
      { head: "Expenditure", main: "Child", sub: "Books", type: "Mandatory", freq: "Not Available", source: "System", percent: 3 },
      { head: "Expenditure", main: "Child", sub: "Child Care", type: "Mandatory", freq: "Not Available", source: "System", percent: 7 },
      { head: "Expenditure", main: "Utilities", sub: "Electricity", type: "Mandatory", freq: "Monthly", source: "System", percent: 10 },
      { head: "Expenditure", main: "Healthcare", sub: "Medicines", type: "Mandatory", freq: "Monthly", source: "System", percent: 5 },
      { head: "Expenditure", main: "Bank Transfer", sub: "Interbank Payment", type: "Optional", freq: "Not Available", source: "System", percent: 2 }
    ];

    function renderTable(income = 0) {
      const tbody = document.getElementById("budgetTableBody");
      tbody.innerHTML = "";
      categories.forEach((cat, i) => {
        const amount = income > 0 ? (income * cat.percent) / 100 : 0;
        tbody.innerHTML += `
          <tr class="border-b hover:bg-gray-50">
            <td class="p-3">${cat.head}</td>
            <td class="p-3">${cat.main}</td>
            <td class="p-3">${cat.sub}</td>
            <td class="p-3">${cat.type}</td>
            <td class="p-3">${cat.freq}</td>
            <td class="p-3"><span class="px-2 py-1 bg-gray-200 rounded text-xs">${cat.source}</span></td>
            <td class="p-3">${cat.percent}%</td>
            <td class="p-3">₹${amount.toFixed(2)}</td>
            <td class="p-3">
              <button class="text-gray-500 hover:text-gray-700">⋮</button>
            </td>
          </tr>
        `;
      });
    }

    function calculateBudget() {
      const income = parseFloat(document.getElementById("incomeInput").value);
      if (isNaN(income) || income <= 0) {
        alert("⚠️ Please enter a valid income.");
        return;
      }
      renderTable(income);
    }

    function openModal() {
      document.getElementById("categoryModal").classList.remove("hidden");
      document.getElementById("categoryModal").classList.add("flex");
    }

    function closeModal() {
      document.getElementById("categoryModal").classList.add("hidden");
      document.getElementById("categoryModal").classList.remove("flex");
    }

    function addCategory() {
      const head = document.getElementById("newHead").value;
      const main = document.getElementById("newMainClass").value;
      const sub = document.getElementById("newSubClass").value;
      const type = document.getElementById("newType").value;
      const freq = document.getElementById("newFreq").value;
      const percent = parseFloat(document.getElementById("newPercent").value);

      if (!main || !sub || isNaN(percent) || percent <= 0) {
        alert("⚠️ Please enter valid category details.");
        return;
      }

      categories.push({ head, main, sub, type, freq, source: "Client", percent });
      closeModal();
      renderTable(parseFloat(document.getElementById("incomeInput").value) || 0);
    }

    // Initial render
    renderTable();
  </script>
</body>
</html>
